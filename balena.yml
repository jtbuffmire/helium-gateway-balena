name: Helium Gateway with RAK2287
type: sw.application
description: >-
  Complete Helium Data-Only Gateway using gateway-rs 1.3.0 and RAK2287 concentrator.
  This application provides a modern, reliable Helium gateway solution for Raspberry Pi 4
  with RAK2287 LoRa concentrator hat.
  
joinable: false

post-provisioning: |
  ## Helium Gateway with RAK2287
  
  This fleet provides a complete Helium Data-Only Gateway solution using:
  - **gateway-rs v1.3.0** - Latest Helium gateway software
  - **RAK2287 LoRa Concentrator** - SX1302-based concentrator with excellent performance
  - **Raspberry Pi 4** - Recommended platform for reliable operation
  
  ### Hardware Requirements
  
  - Raspberry Pi 4 (2GB+ RAM recommended)
  - RAK2287 LoRa concentrator with Pi HAT
  - MicroSD card (32GB+ recommended)
  - Stable power supply (3A+ recommended)
  - Internet connection (Ethernet preferred)
  
  ### Configuration
  
  #### Required Device Variables
  
  Set these in your device's **Device Variables** section:
  
  - `REGION_OVERRIDE` - Your frequency region (e.g., `US915`, `EU868`, `AU915`, `AS923`)
  
  #### Optional Device Variables
  
  - `GATEWAY_EUI` - Custom gateway EUI (auto-generated if not set)
  - `GW_KEYPAIR` - Custom keypair path (uses ECC chip or file storage if not set)
  
  #### GPIO Configuration (GPIOD-compatible)
  
  - `MODEL` - Concentrator model (RAK2287)
  - `CONCENTRATOR` - Concentrator chip type (SX1302)
  - `SPI_SPEED` - SPI communication speed (2000000 Hz)
  
  #### Hardware Configuration
  
  - `CONCENTRATOR_MODEL` - Concentrator model (default: RAK2287)
  - `CONCENTRATOR_CHIP` - Concentrator chip type (default: SX1302)
  - `CONCENTRATOR_INTERFACE` - Interface type (default: SPI)
  - `RADIO_DEV` - Radio device path (default: /dev/spidev0.0)
  - `FREQUENCY_BAND` - Frequency band (default: us_902_928)
  
  #### GPS Configuration
  
  - `GPS_LATITUDE` - GPS latitude (default: 38.851137)
  - `GPS_LONGITUDE` - GPS longitude (default: -121.269953)
  - `GPS_ALTITUDE` - GPS altitude (default: 0)
  - `HAS_GPS` - Enable GPS (default: 0)
  - `HAS_LTE` - Enable LTE (default: 0)
  
  ### Getting Started
  
  1. **Deploy the Application**: Use the "Deploy with balena" button or push this code to your fleet
  2. **Set Region**: Configure `REGION_OVERRIDE` device variable for your location
  3. **Wait for Services**: Both `gateway-service` and `packet-forwarder` should start successfully
  4. **Get Gateway Info**: In the gateway-service terminal, run: `helium_gateway -c /etc/helium_gateway key info`
  5. **Register Gateway**: Use the Helium CLI or Console to register your gateway on the network
  
  ### Service Architecture
  
  - **gateway-service**: Runs gateway-rs, handles blockchain communication
  - **packet-forwarder**: Manages RAK2287 concentrator, forwards LoRa packets
  
  ### Monitoring
  
  Both services include health checks and will restart automatically if they fail.
  Check the logs in each service to monitor operation.
  
  ### Support
  
  - Helium Documentation: https://docs.helium.com/
  - Gateway-rs Repository: https://github.com/helium/gateway-rs
  - RAK2287 Documentation: https://docs.rakwireless.com/
  
assets:
  repository:
    type: blob.asset
    data:
      url: 'https://github.com/helium/gateway-rs'
  logo:
    type: blob.asset
    data:
      url: 'https://avatars.githubusercontent.com/u/22476818?s=200&v=4'

data:
  applicationEnvironmentVariables:
    - REGION_OVERRIDE: US915
    - GATEWAY_EUI: 
    - GW_KEYPAIR: 
    # Packet Forwarder Configuration
    - MODEL: RAK2287
    - CONCENTRATOR: SX1302
    - SPI_SPEED: 2000000
    # Hardware Configuration
    - CONCENTRATOR_MODEL: RAK2287
    - CONCENTRATOR_CHIP: SX1302
    - CONCENTRATOR_INTERFACE: SPI
    - RADIO_DEV: /dev/spidev0.0
    # Frequency Band
    - FREQUENCY_BAND: us_902_928
    # GPS Configuration
    - GPS_LATITUDE: 38.851137
    - GPS_LONGITUDE: -121.269953
    - GPS_ALTITUDE: 0
    - HAS_GPS: 0
    - HAS_LTE: 0
  defaultDeviceType: raspberrypi4-64
  supportedDeviceTypes:
    - raspberrypi4-64
    - raspberrypi3-64

